<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8" />
<title>Boost Media</title>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<style>
  body {
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    background: #111827;
    color: #f1f1f1;
    margin: 0; padding: 0;
  }
  .top-bar {
    background: #4f46e5;
    padding: 12px 20px;
    display: flex;
    justify-content: space-between;
    align-items: center;
  }
  .top-bar span {
    font-weight: bold;
  }
  .top-bar button {
    background: #10b981;
    border: none;
    color: white;
    padding: 8px 14px;
    border-radius: 6px;
    font-weight: bold;
    cursor: pointer;
  }
  #loginSection, #shopSection {
    max-width: 900px;
    margin: 40px auto;
    padding: 0 15px;
  }
  #loginSection {
    max-width: 320px;
    background: #1e293b;
    padding: 30px 20px;
    border-radius: 12px;
  }
  #loginSection h2 {
    text-align: center;
    color: #a5f3fc;
  }
  #loginSection input {
    width: 100%;
    margin: 10px 0;
    padding: 12px;
    border-radius: 8px;
    border: none;
    font-size: 1em;
  }
  #loginSection button {
    width: 100%;
    background: #10b981;
    border: none;
    padding: 12px;
    font-weight: bold;
    border-radius: 8px;
    cursor: pointer;
    margin-top: 10px;
    color: white;
  }
  #loginSection p.toggle {
    text-align: center;
    color: #38bdf8;
    margin-top: 14px;
    cursor: pointer;
  }
  #loginMsg {
    text-align: center;
    color: #f87171;
    margin-top: 10px;
    min-height: 20px;
  }
  h1, h2 {
    color: #a5f3fc;
    text-align: center;
  }
  .products-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit,minmax(260px,1fr));
    gap: 20px;
    margin-top: 30px;
  }
  .product-card {
    background: #1e293b;
    border-radius: 12px;
    padding: 20px;
    text-align: center;
    box-shadow: 0 0 10px rgba(0,0,0,0.3);
  }
  .product-card img {
    max-height: 70px;
    margin-bottom: 12px;
  }
  .product-card h3 {
    margin: 10px 0 6px;
    color: #fcd34d;
  }
  .product-card p {
    margin-bottom: 12px;
    font-weight: bold;
    font-size: 1.1em;
  }
  .product-card button {
    background: #10b981;
    border: none;
    padding: 10px 15px;
    border-radius: 8px;
    font-weight: bold;
    color: white;
    cursor: pointer;
  }
  #cart {
    background: #1e293b;
    max-width: 900px;
    margin: 30px auto;
    padding: 20px;
    border-radius: 12px;
  }
  #cart h2 {
    color: #a5f3fc;
  }
  #cart-items {
    margin-top: 15px;
  }
  .cart-item {
    display: flex;
    justify-content: space-between;
    background: #111827;
    padding: 12px 15px;
    border-radius: 8px;
    margin-bottom: 10px;
  }
  .cart-item span {
    font-weight: bold;
  }
  .cart-item button {
    background: #ef4444;
    border: none;
    color: white;
    padding: 5px 10px;
    border-radius: 6px;
    cursor: pointer;
    font-weight: bold;
  }
  #couponSection {
    margin-top: 20px;
    display: flex;
    justify-content: center;
    gap: 10px;
  }
  #couponInput {
    padding: 10px;
    border-radius: 8px;
    border: none;
    width: 200px;
    font-size: 1em;
  }
  #applyCouponBtn {
    background: #3b82f6;
    border: none;
    color: white;
    padding: 10px 15px;
    border-radius: 8px;
    cursor: pointer;
    font-weight: bold;
  }
  #couponMsg {
    text-align: center;
    margin-top: 10px;
    min-height: 20px;
  }
  #totalPrice {
    font-weight: bold;
    font-size: 1.3em;
    margin-top: 15px;
    text-align: right;
  }
  #checkoutBtn {
    background: #10b981;
    border: none;
    width: 100%;
    padding: 15px;
    font-weight: bold;
    color: white;
    border-radius: 8px;
    margin-top: 25px;
    cursor: pointer;
  }
</style>
</head>
<body>

  <div class="top-bar" id="topBar" style="display:none;">
    <span id="userEmail"></span>
    <button onclick="logout()">Sair</button>
  </div>

  <section id="loginSection">
    <h2 id="formTitle">Login</h2>
    <input type="email" id="email" placeholder="Seu email" />
    <input type="password" id="password" placeholder="Senha" />
    <button id="authBtn">Entrar</button>
    <p class="toggle" id="toggleForm">Não tem conta? Cadastre-se</p>
    <p id="loginMsg"></p>
  </section>

  <section id="shopSection" style="display:none;">
    <h1>Boost Media - Contas Premium</h1>

    <div class="products-grid" id="productsGrid">
      <!-- Produtos vão ser inseridos por JS -->
    </div>

    <div id="cart">
      <h2>Carrinho</h2>
      <div id="cart-items"></div>
      <div id="couponSection">
        <input type="text" id="couponInput" placeholder="Digite o cupom" />
        <button id="applyCouponBtn">Aplicar Cupom</button>
      </div>
      <p id="couponMsg"></p>
      <p id="totalPrice">Total: R$ 0,00</p>
      <button id="checkoutBtn">Finalizar Compra</button>
    </div>
  </section>

  <!-- Firebase -->
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>

  <script>
    const firebaseConfig = {
      apiKey: "AIzaSyDBTpV4najUw7DtI5nCXfsb9wHLlgnnsj0",
      authDomain: "boostmidia-874f1.firebaseapp.com",
      projectId: "boostmidia-874f1",
      storageBucket: "boostmidia-874f1.appspot.com",
      messagingSenderId: "182351458835",
      appId: "1:182351458835:web:a89b0c677574c39537c5e6"
    };

    firebase.initializeApp(firebaseConfig);
    const auth = firebase.auth();

    // Produtos
    const products = [
      { id: 1, name: "YouTube Premium", price: 15.00, icon: "https://img.icons8.com/color/96/youtube-premium.png" },
      { id: 2, name: "Netflix", price: 20.00, icon: "https://img.icons8.com/color/96/netflix.png" },
      { id: 3, name: "Prime Video", price: 10.00, icon: "https://img.icons8.com/color/96/amazon-prime-video.png" },
      { id: 4, name: "Disney+", price: 12.00, icon: "https://img.icons8.com/color/96/disney-plus.png" },
      { id: 5, name: "HBO Max", price: 15.00, icon: "https://img.icons8.com/color/96/hbo.png" },
      { id: 6, name: "Paramount+", price: 10.00, icon: "https://img.icons8.com/color/96/paramount-plus.png" },
      { id: 7, name: "Spotify Premium", price: 50.00, icon: "https://img.icons8.com/color/96/spotify.png" },
      { id: 8, name: "Youcine", price: 15.00, icon: "https://img.icons8.com/color/96/tv.png" }
    ];

    // Cupom válido
    const validCoupon = {
      code: "Bost25",
      discountPercent: 20,
      expireAt: new Date(new Date().getTime() + 24*60*60*1000) // 24 horas a partir do carregamento da página
    };

    let cart = [];
    let discountApplied = 0;

    // DOM Elements
    const loginSection = document.getElementById("loginSection");
    const shopSection = document.getElementById("shopSection");
    const topBar = document.getElementById("topBar");
    const userEmail = document.getElementById("userEmail");
    const formTitle = document.getElementById("formTitle");
    const authBtn = document.getElementById("authBtn");
    const toggleForm = document.getElementById("toggleForm");
    const loginMsg = document.getElementById("loginMsg");
    const productsGrid = document.getElementById("productsGrid");
    const cartItemsDiv = document.getElementById("cart-items");
    const couponInput = document.getElementById("couponInput");
    const applyCouponBtn = document.getElementById("applyCouponBtn");
    const couponMsg = document.getElementById("couponMsg");
    const totalPriceP = document.getElementById("totalPrice");
    const checkoutBtn = document.getElementById("checkoutBtn");

    let isLogin = true;

    // Alternar entre login e cadastro
    toggleForm.onclick = () => {
      isLogin = !isLogin;
      formTitle.innerText = isLogin ? "Login" : "Cadastro";
      authBtn.innerText = isLogin ? "Entrar" : "Cadastrar";
      toggleForm.innerText = isLogin ? "Não tem conta? Cadastre-se" : "Já tem conta? Fazer login";
      loginMsg.innerText = "";
    };

    // Função para autenticar usuário
    authBtn.onclick = () => {
      const email = document.getElementById("email").value.trim();
      const password = document.getElementById("password").value.trim();
      loginMsg.innerText = "";

      if (!email || !password) {
        loginMsg.innerText = "Preencha todos os campos.";
        return;
      }

      if (isLogin) {
        auth.signInWithEmailAndPassword(email, password)
          .catch(e => loginMsg.innerText = e.message);
      } else {
        auth.createUserWithEmailAndPassword(email, password)
          .then(() => {
            loginMsg.style.color = "#22c55e";
            loginMsg.innerText = "Cadastro realizado! Agora faça login.";
            isLogin = true;
            formTitle.innerText = "Login";
            authBtn.innerText = "Entrar";
            toggleForm.innerText = "Não tem conta? Cadastre-se";
          })
          .catch(e => loginMsg.innerText = e.message);
      }
    };

    // Atualiza UI quando o estado de login muda
    auth.onAuthStateChanged(user => {
      if (user) {
        loginSection.style.display = "none";
        shopSection.style.display = "block";
        topBar.style.display = "flex";
        userEmail.textContent = user.email;
        renderProducts();
        renderCart();
      } else {
        loginSection.style.display = "block";
        shopSection.style.display = "none";
        topBar.style.display = "none";
        cart = [];
        discountApplied = 0;
        couponInput.value = "";
        couponMsg.innerText = "";
      }
    });

    function logout() {
      auth.signOut();
    }

    // Renderiza produtos na loja
    function renderProducts() {
      productsGrid.innerHTML = "";
      products.forEach(p => {
        const div = document.createElement("div");
        div.className = "product-card";
        div.innerHTML = `
          <img src="${p.icon}" alt="${p.name}" />
          <h3>${p.name}</h3>
          <p>R$ ${p.price.toFixed(2)}</p>
          <button onclick="addToCart(${p.id})">Adicionar ao Carrinho</button>
        `;
        productsGrid.appendChild(div);
      });
    }

    // Adiciona produto ao carrinho
    window.addToCart = function(productId) {
      const product = products.find(p => p.id === productId);
      if (!product) return;
      const found = cart.find(i => i.id === productId);
      if (found) {
        found.qty++;
      } else {
        cart.push({...product, qty: 1});
      }
      renderCart();
    };

    // Remove produto do carrinho
    window.removeFromCart = function(productId) {
      cart = cart.filter(i => i.id !== productId);
      renderCart();
    };

    // Renderiza o carrinho
    function renderCart() {
      cartItemsDiv.innerHTML = "";
      if (cart.length === 0) {
        cartItemsDiv.innerHTML = "<p>Carrinho vazio.</p>";
        totalPriceP.innerText = "Total: R$ 0,00";
        return;
      }

      let total = 0;
      cart.forEach(item => {
        const itemTotal = item.price * item.qty;
        total += itemTotal;
        const div = document.createElement("div");
        div.className = "cart-item";
        div.innerHTML = `
          <span>${item.name} (x${item.qty}) - R$ ${(itemTotal).toFixed(2)}</span>
          <button onclick="removeFromCart(${item.id})">Remover</button>
        `;
        cartItemsDiv.appendChild(div);
      });

      // Aplica desconto se cupom válido
      if (discountApplied > 0) {
        const discountValue = total * (discountApplied/100);
        total = total - discountValue;
        couponMsg.style.color = "#22c55e";
        couponMsg.innerText = "Desconto de " + discountApplied + "% aplicado!";
      } else {
        couponMsg.innerText = "";
      }

      totalPriceP.innerText = "Total: R$ " + total.toFixed(2);
    }

    // Aplica cupom
    applyCouponBtn.onclick = () => {
      const code = couponInput.value.trim();
      if (!code) {
        couponMsg.style.color = "#ef4444";
        couponMsg.innerText = "Digite um código de cupom.";
        return;
      }
      if (code.toUpperCase() === validCoupon.code.toUpperCase()) {
        const now = new Date();
        if (now > validCoupon.expireAt) {
          couponMsg.style.color = "#ef4444";
          couponMsg.innerText = "Cupom expirado.";
        } else {
          discountApplied = validCoupon.discountPercent;
          renderCart();
        }
      } else {
        couponMsg.style.color = "#ef4444";
        couponMsg.innerText = "Cupom inválido.";
      }
    };

    // Finaliza compra e abre WhatsApp com resumo
    checkoutBtn.onclick = () => {
      if (cart.length === 0) {
        alert("Seu carrinho está vazio!");
        return;
      }
      const phone = "5565999468323"; // seu número WhatsApp
      let msg = "Olá, quero comprar esses produtos:%0A";
      let total = 0;

      cart.forEach(item => {
        const itemTotal = item.price * item.qty;
        total += itemTotal;
        msg += `- ${item.name} (x${item.qty}) - R$ ${(itemTotal).toFixed(2)}%0A`;
      });

      if (discountApplied > 0) {
        const discountValue = total * (discountApplied/100);
        total = total - discountValue;
        msg += `%0ADesconto aplicado: ${discountApplied}%25%0A`;
      }

      msg += `%0ATotal: R$ ${total.toFixed(2)}`;

      const url = `https://wa.me/${phone}?text=${msg}`;
      window.open(url, "_blank");
    };
  </script>

</body>
</html>
